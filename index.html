<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>LAZARO WORLD — GTA 1 Style</title>
<style>
html,body{margin:0;background:#000;overflow:hidden}
canvas{width:100vw;height:100vh;image-rendering:pixelated}
#hint{position:fixed;top:10px;left:10px;color:#fff;background:rgba(0,0,0,.7);
padding:10px;border-radius:10px;font:14px system-ui}
</style>
</head>
<body>
<canvas id="c"></canvas>
<div id="hint">Click tiles: PAVEMENT → ROAD → PARK → WATER</div>

<script>
const c=document.getElementById("c"),x=c.getContext("2d");
c.width=innerWidth;c.height=innerHeight;

const TILE=32;
const tiles=new Image();
tiles.src="assets/sTiles.png";

let pick=["pavement","road","park","water"];
let picked={},step=0;

tiles.onload=()=>drawPicker();

function drawPicker(){
  x.fillStyle="#000";x.fillRect(0,0,c.width,c.height);
  x.drawImage(tiles,20,60);
  x.fillStyle="#fff";
  x.fillText("CLICK: "+pick[step].toUpperCase(),20,40);
}

c.onclick=e=>{
  if(step>=4)return;
  const ox=20,oy=60;
  const mx=e.clientX-ox,my=e.clientY-oy;
  if(mx<0||my<0||mx>tiles.width||my>tiles.height)return;

  const cols=(tiles.width/TILE)|0;
  const id=((my/TILE)|0)*cols+((mx/TILE)|0);
  picked[pick[step]]=id;
  step++;

  if(step===4){
    localStorage.setItem("LW_TILES",JSON.stringify(picked));
    location.reload();
  }else drawPicker();
};

const saved=JSON.parse(localStorage.getItem("LW_TILES")||"null");
if(saved) startGame(saved);

function startGame(S){
  document.getElementById("hint").innerHTML=
  "WASD move • G remix city";

  const MAP_W=60,MAP_H=40;
  const map=new Uint8Array(MAP_W*MAP_H);

  function gen(){
    map.fill(0);
    for(let y=0;y<MAP_H;y++)for(let x=0;x<MAP_W;x++){
      if(x%8==0||y%8==0)map[y*MAP_W+x]=1;
      if(x>MAP_W-6)map[y*MAP_W+x]=3;
      if(Math.random()<.03)map[y*MAP_W+x]=2;
    }
  }
  gen();

  function draw(){
    x.fillStyle="#000";x.fillRect(0,0,c.width,c.height);
    for(let y=0;y<MAP_H;y++)for(let x0=0;x0<MAP_W;x0++){
      let t=map[y*MAP_W+x0];
      let id=S.pavement;
      if(t==1)id=S.road;
      if(t==2)id=S.park;
      if(t==3)id=S.water;
      drawTile(id,x0*TILE,y*TILE);
    }
    requestAnimationFrame(draw);
  }

  function drawTile(id,dx,dy){
    const cols=(tiles.width/TILE)|0;
    const sx=(id%cols)*TILE;
    const sy=((id/cols)|0)*TILE;
    x.drawImage(tiles,sx,sy,TILE,TILE,dx,dy,TILE,TILE);
  }
  draw();
}
</script>
</body>
</html>
